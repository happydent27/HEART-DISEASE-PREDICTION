# -*- coding: utf-8 -*-
"""Copy of Heart.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1zZcpULwTD1QcjpQg-TfDcQNVTgfLHHIA
"""

import pandas as pd
import numpy as np

new_data = pd.read_csv('heart.csv')

new_data.head(5)

new_data.info()

from sklearn.preprocessing import LabelEncoder
lbcode=LabelEncoder()
new_data["Sex"]=lbcode.fit_transform(new_data["Sex"])
new_data["ChestPainType"]=lbcode.fit_transform(new_data["ChestPainType"])
new_data["RestingECG"]=lbcode.fit_transform(new_data["RestingECG"])
new_data["ExerciseAngina"]=lbcode.fit_transform(new_data["ExerciseAngina"])
new_data["ST_Slope"]=lbcode.fit_transform(new_data["ST_Slope"])

new_data

a=new_data.drop('HeartDisease',axis=1)
b=new_data.HeartDisease

from sklearn.model_selection import train_test_split
a_train,a_test,b_train,b_test=train_test_split(a,b,test_size=0.25,random_state=41)

from sklearn import metrics
def predict(ml_model):
    model= ml_model.fit(a_train,b_train)
    predictions = model.predict(a_test)
    print('accuracy score is: ',metrics.accuracy_score(b_test,predictions))
    print('f1_score is: ',np.sqrt(metrics.f1_score(b_test,predictions)))

from sklearn.naive_bayes import GaussianNB
predict(GaussianNB())

gauss=GaussianNB()
gauss.fit(a,b)

import pickle

pickle.dump(gauss, open("model.pkl","wb"))